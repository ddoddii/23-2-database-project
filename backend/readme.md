# Database Project
- Author : 2019143073 엄소은
## ER-Diagram & Mapping ERD to Relational Schema

### 1. ER-Diagram
<img width="663" alt="image" src="https://github.com/ddoddii/ddoddii.github.io/assets/95014836/86105c22-6dfa-4215-b5f0-b9cb897cc26d">

### 2. Relational Schema
<img width="806" alt="image" src="https://github.com/ddoddii/ddoddii.github.io/assets/95014836/b6dbf4fb-df91-4d61-870d-d9ba90779250">

### 3. ERD 작성과 관련해 가정한 내용
1. 사용자는 다른 사용자의 글을 편집하거나 삭제할 수 없다.
2. 사용자는 본인의 글 및 답글에 '도움이 되어요' 를 클릭할 수 없다.

### 4. 일정
- 11/20
  - [X] 스키마 설계
  - [X] 데이터베이스 세팅
  - [X] 사용자 로그인 기능 구현∏
- 11/27 : 
  - [X] 글 작성 기능
  - [X] 글 편집 기능
  - [X] 답글 기능
  - [X] 검색 기능
- 12/4
  - [ ] 조회 기능
  - [X] 중요도 기능
  - [ ] 자동 삭제 기능
- 12/11
  - [ ] 보고서 작성

## 시스템 설계 문서 및 중간 구현 내용
- Server Framework : FastAPI
- python version : 3.10
- RDBMS : MySQL

### Application Flowchart

<img width="863" alt="image" src="https://github.com/ddoddii/ddoddii.github.io/assets/95014836/e51b3777-a685-44c0-bc2e-79117fe29bd9">

-------
## 기능 명세
### 사용자 관리
- [X] 사용자 만드는 기능
  - [X] 사용자 type 은 관리자(1), 일반 사용자(0) 으로 한다
- [X] 사용자 로그인 기능
- [ ] 관리자는 사용자의 목록과 글 제출 상태를 관리할 수 있다. 

### 글 쓰기
- [X] 사용자가 로그인해서 글을 쓴다.
  - [X] 글 내용은 이미지, 비디오 가 포함될 수 있다.
  - [X] 보여지는 글에는 작성시간, 수정시간, 글 작성자, 글 내용, 글 조회수가 있다. 
- [X] 처음 글을 쓰면 조회수(view_count) 는 0이고, 중요도(help_count)도 0이다.
- [X] 사용자는 본인이 작성한 글을 편집할 수 있다. 
- [X] 사용자는 본인이 작성한 글을 삭제할 수 있다.

### 답글 쓰기
- [X] 사용자는 로그인해서 다른 사용자들의 글 / 본인의 글에 답글을 달 수 있다.
- [ ] 사용자는 본인이 작성한 답글을 편집할 수 있다. 
- [ ] 사용자는 본인이 작성한 답글을 삭제할 수 있다.

### 글 / 답글 조회
- [X] 사용자는 키워드로 글을 검색할 수 있다.
- [X] 사용자는 로그인해서 다른 사용자들의 글 / 답글을 볼 수 있다.
- [ ] 사용자가 글 / 답글의 내용을 볼 때마다 조회수가 1 씩 올라간다. 
- [ ] 사용자는 작성시간 , 조회수, 중요도 수 등의 조건으로 글을 조회할 수 있다.

### 중요해요 누르기
- [ ] 사용자는 로그인해서 다른 사람의 글 / 답글에 '추천' 를 선택할 수 있다.
- [X] '추천' 을 선택하면 글/답글의 help_count 가 1씩 증가한다. 
- [ ] 사용자는 '중요해요' 를 다시 클릭해서 취소할 수 있다. 

### 중요도 관리
- [ ] **중요도 = [('중요해요' 누적 클릭수) + 조회수] * 감쇄율** 이며, 매일 자정에 갱신된다.
- [ ] 감쇄율은 아래와 같으며, 주기별로 감쇄가 이루어진다. 
  ```json
  {
      "decayPeriod": "7", 
      "decayRate": "0.8",
      "threshold": "3", 
      "viewsWeight": "0.5", 
      "clicksWeight": "0.5" 
  }
  ```
- [ ] 중요도가 임계값보다 낮은 글 / 답글은 자동으로 삭제된다. 
  - [ ] 예를 들어, 작성 시점이 12/5일 인 글을 보자.
    - 12/5 자정 : 조회수 5, '중요해요' : 1 이면, 중요도 = [5 + 1]* 0.8 = 4.8 이다. 
    - 12/6 자정 : 조회수 10, '중요해요' : 3 이면, 중요도 = [10 * 0.5 + 3 * 0.5]* 0.8^2 = 4.16 이다. 
    - 12/7 자정 : 조회수 30, '중요해요' : 5 이면, 중요도 = [20 * 0.5^2 + 5 * 0.5^2] * 0.8^3 = 4.48 이다. 
    - 12/8 자정 : 조회수 40, '중요해요' : 6 이면, 중요도 = [40 * 0.5^3 + 6 * 0.5^3] * 0.8^3 = 2.994 이다. 
    - 12/8 에 글의 중요도가 임계값(3) 이하이므로 글은 자동삭제 된다.